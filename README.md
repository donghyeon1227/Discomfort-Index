# ðŸŒ¡ï¸Discomfort-Index ê¸°ë°˜ í™˜ê²½ ëª¨ë‹ˆí„°ë§ & UI ì‹œìŠ¤í…œ (Linux Kernel Device Driver) (ê¸°ê°„ ê¸°ìž…) [íŒ€/ê°œì¸ ê¸°ìž…]  
> **RTC + ì˜¨ìŠµë„(DHT11) + ë¡œí„°ë¦¬ì—”ì½”ë”(IRQ) + OLED(SSD1306) + LED Bar**ë¥¼ ì—°ë™í•˜ì—¬  
> **í˜„ìž¬ ì‹œê°„/ì˜¨ìŠµë„/ë¶ˆì¾Œì§€ìˆ˜(Discomfort Index)** ë¥¼ í‘œì‹œí•˜ê³ , **ë¶ˆì¾Œì§€ìˆ˜ ë‹¨ê³„ì— ë”°ë¼ LED Barë¥¼ ìžë™ ì œì–´**í•˜ëŠ” ìž„ë² ë””ë“œ ë¦¬ëˆ…ìŠ¤ í”„ë¡œì íŠ¸

---

## 1) í”„ë¡œì íŠ¸ ì†Œê°œ
ë³¸ í”„ë¡œì íŠ¸ëŠ” Linux SBC(ì˜ˆ: Raspberry Pi) í™˜ê²½ì—ì„œ  
**ì»¤ë„ ë””ë°”ì´ìŠ¤ ë“œë¼ì´ë²„(/dev/clock_drv)** ë¥¼ í†µí•´ í•˜ë“œì›¨ì–´(DS1302, DHT11, Rotary Encoder, LED Bar)ë¥¼ ì œì–´í•˜ê³ ,  
ìœ ì € ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ **SSD1306 OLED UI(3íŽ˜ì´ì§€)** ë¡œ ìƒíƒœë¥¼ ì‹œê°í™”í•˜ëŠ” ì‹œìŠ¤í…œìž…ë‹ˆë‹¤.

- **Kernel ì˜ì—­**: ì‹¤ì‹œê°„ ìž…ë ¥(IRQ), ì„¼ì„œ ì½ê¸°, LED ì œì–´, RTC ì½ê¸°/ì„¤ì •
- **User ì˜ì—­**: OLED ë Œë”ë§(UI) + ë¶ˆì¾Œì§€ìˆ˜ ê³„ì‚° + LED ë‹¨ê³„ ì œì–´

---

## 2) í•µì‹¬ ê¸°ëŠ¥ (Core Features)
- âœ… **DS1302 RTC ì‹œê°„ Read/Write** (BCD ë³€í™˜ í¬í•¨)
- âœ… **ë¡œí„°ë¦¬ ì—”ì½”ë” IRQ ê¸°ë°˜ ìž…ë ¥ ì²˜ë¦¬** (íŽ˜ì´ì§€ ì „í™˜ / ì‹œê°„ íŽ¸ì§‘)
- âœ… **SW ë²„íŠ¼ Short/Long Press ì²˜ë¦¬**
  - Short: íŽ¸ì§‘ í•„ë“œ ë³€ê²½(HOURâ†’MINâ†’SEC)
  - Long(â‰¥1ì´ˆ): íŽ¸ì§‘ ëª¨ë“œ ì§„ìž…/ì €ìž¥(DS1302 ë°˜ì˜)
- âœ… **DHT11 ì˜¨ìŠµë„ ì¸¡ì • + ìºì‹±(DHT_CACHE_MS=2000ms)** ë¡œ ì•ˆì •ì„±/ë¶€í•˜ ê°œì„ 
- âœ… **ë¶ˆì¾Œì§€ìˆ˜(Discomfort Index) ê³„ì‚° ë° ë“±ê¸‰í™”**
- âœ… **8-LED Bar ë‹¨ê³„ ì¶œë ¥(0~8ë‹¨ê³„)**
- âœ… **OLED(SSD1306 I2C, 0x3C) 3íŽ˜ì´ì§€ UI í‘œì‹œ**
  1) Clock(RUN/EDIT)  2) Weather(Temp/Hum)  3) DI(ë¶ˆì¾Œì§€ìˆ˜ + ì•„ì´ì½˜ + LED)

---

## 3) ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì„± (Hardware)

### 3-1. êµ¬ì„± ìš”ì†Œ
- **Linux SBC (Raspberry Pi ë“±)**: ì»¤ë„ ë“œë¼ì´ë²„ + ìœ ì €ì•± ì‹¤í–‰
- **DS1302 RTC**: í˜„ìž¬ ì‹œê°„ ìœ ì§€ ë° ì„¤ì •(ì „ì› OFF ëŒ€ë¹„)
- **DHT11**: ì˜¨ë„/ìŠµë„ ìž…ë ¥
- **Rotary Encoder(S1/S2/SW)**: UI íŽ˜ì´ì§€ ì´ë™ / ì‹œê°„ íŽ¸ì§‘ ìž…ë ¥(IRQ)
- **SSD1306 OLED(128x64, I2C, 0x3C)**: UI ì¶œë ¥
- **8-LED Bar**: ë¶ˆì¾Œì§€ìˆ˜ ë‹¨ê³„ í‘œì‹œ

---

### 3-2. GPIO ë§¤í•‘(BCM, ì½”ë“œ ê¸°ì¤€: `driver.c`)
| êµ¬ë¶„ | í•€ | GPIO(BCM) | ì˜ë¯¸ |
|---|---:|---:|---|
| RTC | RST | 17 | DS1302 Reset |
| RTC | DAT | 4 | DS1302 Data |
| RTC | SCLK | 22 | DS1302 Clock |
| Encoder | S1 | 24 | íšŒì „ ìž…ë ¥(IRQ) |
| Encoder | S2 | 25 | ë°©í–¥ íŒë³„ |
| Encoder | SW | 26 | ë²„íŠ¼ ìž…ë ¥(IRQ) |
| Sensor | DHT | 23 | DHT11 DATA |
| LED Bar | LED0~7 | 5,6,12,13,16,19,20,21 | ë‹¨ê³„ ì¶œë ¥ |

---

### 3-3. ì „ì²´ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ëž¨
```text
[Rotary Encoder] --(GPIO24/25/26, IRQ)--> [Kernel Driver]
[DS1302 RTC]     --(GPIO17/4/22)-------> [Kernel Driver] ---> /dev/clock_drv
[DHT11]          --(GPIO23)------------> [Kernel Driver]
[LED BAR]        <--(GPIO5..21)-------- [Kernel Driver]

/dev/clock_drv  <---- read/write ---->  [User Application]
                                       |
                                       +--(I2C /dev/i2c-1, addr 0x3C)--> [SSD1306 OLED]
